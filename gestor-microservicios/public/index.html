<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Gestor de Microservicios</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸš€ Gestor de Microservicios - Roble</h1>
      <p>AdministraciÃ³n dinÃ¡mica de microservicios con Docker</p>
    </header>

    <nav class="tabs">
      <button class="tab-btn active" data-tab="microservices">ðŸ“¦ Microservicios</button>
      <button class="tab-btn" data-tab="create">âž• Crear Nuevo</button>
    </nav>

    <!-- Tab: Lista de Microservicios -->
    <div id="microservices-tab" class="tab-content active">
      <div class="section-header">
        <h2>Microservicios Desplegados</h2>
        <button class="btn btn-primary" onclick="loadMicroservices()">ðŸ”„ Actualizar</button>
      </div>
      
      <div id="microservices-list" class="microservices-grid">
        <div class="loading">Cargando microservicios...</div>
      </div>
    </div>

    <!-- Tab: Crear Microservicio -->
    <div id="create-tab" class="tab-content">
      <h2>Crear Nuevo Microservicio</h2>
      
      <form id="create-form" class="form">
        <div class="form-group">
          <label for="ms-name">Nombre del Microservicio *</label>
          <input type="text" id="ms-name" required placeholder="Ej: Mi Servicio de Productos">
        </div>

        <div class="form-group">
          <label for="ms-description">DescripciÃ³n</label>
          <textarea id="ms-description" rows="2" placeholder="DescripciÃ³n del microservicio"></textarea>
        </div>

        <div class="form-group">
          <label for="ms-code">CÃ³digo del Microservicio (index.js) *</label>
          <textarea id="ms-code" rows="15" required placeholder="const express = require('express');
const app = express();

app.get('/api/hello', (req, res) => {
  res.json({ message: 'Hola Mundo' });
});

app.listen(3000, () => {
  console.log('Servidor corriendo en puerto 3000');
});"></textarea>
          <small style="color: var(--text-light);">El servidor debe escuchar en el puerto 3000</small>
        </div>

        <div class="form-group">
          <label for="ms-dependencies">Dependencias NPM (una por lÃ­nea) *</label>
          <textarea id="ms-dependencies" rows="4" required placeholder="express
axios
dotenv"></textarea>
          <small style="color: var(--text-light);">Escribe el nombre de cada paquete en una lÃ­nea separada</small>
        </div>

        <div class="form-group">
          <label for="ms-base-image">Imagen Base de Docker</label>
          <input type="text" id="ms-base-image" value="node:18-alpine" placeholder="node:18-alpine">
          <small style="color: var(--text-light);">Por defecto: node:18-alpine</small>
        </div>

        <div class="form-group">
          <label>Variables de Entorno (opcional)</label>
          <div id="env-vars">
            <div class="env-var-row">
              <input type="text" placeholder="ROBLE_BASE_URL" class="env-key">
              <input type="text" placeholder="https://roble-api.openlab.uninorte.edu.co" class="env-value">
            </div>
            <div class="env-var-row">
              <input type="text" placeholder="ROBLE_PROJECT_ID" class="env-key">
              <input type="text" placeholder="pc2_3e6afe53f1" class="env-value">
            </div>
          </div>
          <button type="button" class="btn btn-secondary btn-sm" onclick="addEnvVar()">+ Agregar Variable</button>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-success">ðŸš€ Crear y Desplegar</button>
          <button type="reset" class="btn btn-secondary">ðŸ”„ Limpiar</button>
        </div>
      </form>

      <div id="create-status" class="status-message" style="display: none;"></div>
    </div>
  </div>

  <!-- Modal para Detalles/EdiciÃ³n -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <div id="modal-body"></div>
    </div>
  </div>

  <!-- Modal para Probar Endpoint -->
  <div id="test-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeTestModal()">&times;</span>
      <h2>ðŸ§ª Probar Endpoint</h2>
      <div id="test-modal-body"></div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
